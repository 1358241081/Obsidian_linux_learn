### 用户相关命令
**增删改**
>- useradd:  添加用户
>- [[用户与群组#userdel|userdel]]:　删除用户
>- usermod:　修改用户信息
>- passwd：修改用户密码
>- chsh：　修改用户默认bash [[用户与群组#nologin与false|1]] [[用户与群组#01shell shell类型与环境变量 shell类型与环境变量|2]]

**查看**
>- id:　当前用户信息
>- w：	用于显示目前登入系统的用户信息。
>- who：Linux who命令用于显示系统中有哪些使用者正在上面，显示的资料包含了使用者 ID、使用的终端机、从哪边连上来的、上线时间、呆滞时间、CPU 使用量、动作等等。
>- whoami：当前登陆用户

**提权**
>- su：　切换用户
>- [[用户与群组#sudo|sudo]]：　使用root权限[[用户与群组#添加sudo命令|3]]
>- [[用户与群组#visudo|visudo]]：修改sudoers文件


###  组相关命令
**增删改**
>- groupadd:　添加组
>- groupdel：　删除组
>- [[用户与群组#groupmod|groupmod]]：更改群组的识别码或名称
>- [[用户与群组#groupmems|groupmems]]：用户主组的管理员成员

**查看**
>- groups:查看组信息


 

### 配置文件
**用户**
>- [[用户与群组#etc passwd|/etc/passwd]]　:用户配置文件
>- [[用户与群组#etc shadow|/etc/shadow]]	   :用户密码

**组**
>- [[用户与群组#etc group|/etc/group]]	　   :组配置文件
>- [[用户与群组#etc gshadow|/etc/gshadow]]　   :组密码
>
**sudo命令配置文件**
>- [[用户与群组#sudoers文件|/etc/sudoers]]



*****
#### 附录

#####  userdel

>![[Pasted image 20211117093149.png]]

当删除用户时　如果该用户存在正在使用的进程会导致删除失败
>![[Pasted image 20211116173802.png]]
>
##### groupmod
>![[Pasted image 20211117102139.png]]
##### groupmems
>![[Pasted image 20211117101935.png]]
```bash
uos@uos-PC /etc> sudo groupmems -g sudo -l
uos  uos2 
uos@uos-PC /etc> 
```

##### nologin与false
/bin/nologin，/bin/false的意思是禁止某个用户登录。

比较常用的用法：

-添加一个不能登录的用户
>useradd -d /usr/local/apache -g apache -s /bin/false apache

-要拒绝系统用户登录，可以将其shell设置为/usr/sbin/nologin或者/bin/false

>usermod -s /usr/sbin/nologin username

或者

>usermod -s /bin/false username

说明及比较：

/bin/false什么也不做只是返回一个错误状态，然后立即退出。将用户的shell设置为/bin/false，用户会无法登录，并且不会有任何提示。

/usr/sbin/nologin会礼貌的向用户显示一条信息，并拒绝用户登录：

>This account is currently not available.

有一些软件，比如一些ftp服务器软件，对于本地非虚拟账户，只有用户有有效的shell才能使用ftp服务。这时候就可以使用nologin使用户即不能登录系统，还能使用一些系统服务，比如ftp服务。/bin/false则不行，这是二者的重要区别之一。

/etc/nologin

如果存在/etc/nologin文件，则系统只允许root用户登录，其他用户全部被拒绝登录，并向他们显示/etc/nologin文件的内容。


##### [[01shell#shell类型与环境变量|shell类型与环境变量]]

##### sudo
![[Pasted image 20211117113145.png]]

#####  添加sudo命令
新创建的用户如果没有指定加入sudo组(uos)/wheel组(centos)　是无法使用该命令，但是也不是绝对如此，可以通过配置/etc/sudoers文件使用sudo命令
- centos
>![[Pasted image 20211117110938.png]]

- uos
>![[Pasted image 20211117111001.png]]

可以看到centos和uos系统上的sudo命令属主和属组都是root 
而且都设置了[[03权限控制#粘贴位|粘贴位]] ，这也能解释了sudo提权的方式。


##### sudoers文件
sudo命令默认的安全策略文件，用来鉴定用户是否可以使用sudo命令。

可以看到这个文件是只读的　如果想要修改　建议使用[[用户与群组#visudo|visudo]]

- 在uos系统上是sudo组
>![[Pasted image 20211117112302.png]]

- 在centos系统上是wheel组
>![[Pasted image 20211117112627.png]]

- sudoers文件简要修改规则
>![[Pasted image 20211117113534.png]]

##### visudo
visudo 以安全的方式编辑 sudoers 文件，类似于 vipw(8)。 visudo 将 sudoers 文件锁定为 multi-ple 同时编辑，提供基本的健全性检查，并检查解析错误。如果 sudoers 文件当前是正在编辑中，您将收到一条消息，稍后再试。
visudo 会在编辑后解析 sudoers 文件，如果出现语法错误，则不会保存更改。一经发现错误，visudo 将打印一条消息，说明发生错误的行号，用户将收到“现在怎么办？”提示。
此时用户可以输入“e”重新编辑sudoers文件，“x”退出不保存更改，或“Q”退出并保存更改。
使用“Q”选项时应格外小心，因为如果 visudo相信存在解析错误，因此 sudo 也将如此，并且在错误修复之前，没有人能够再次运行 sudo。
如果在检测到解析错误后键入“e”来编辑 sudoers 文件，则光标将放置在该行上发生错误的地方（如果编辑器支持此功能）。


#####  /etc/passwd

#####  /etc/shadow

#####  /etc/group

#####  /etc/gshadow

