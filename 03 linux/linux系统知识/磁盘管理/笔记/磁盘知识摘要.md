## 目的

作为磁盘科普类型的文档，不涉及详细的理论知识，仅作为科普性质

### 机械硬盘
#### 数据存储原理
磁头在高速运转的磁盘上到达预先指定位置对数据进行读写操作。
数据信息通过离磁性表面仅一根发丝直径大小的磁头，以电磁流改变极性方式写到磁盘上，数据信息可以通过相反的方式读取。

存储区/磁盘是磁性物质，这些磁性物质的磁极可以被磁头改变，利用磁极的正反来代表电脑里面的0和1，起到数据存储的作用。
写入数据的过程实际上是通过磁头对磁盘表面非常小的磁性物质的磁极进行改变的过程。
#### 硬盘结构
下图就是机械硬盘的结构，所有的盘片都固定在一个旋转轴上，这个轴即盘片主轴。
所有的盘片之间是绝对平行的，且在每个盘片的盘面上都有一个磁头来对磁盘上的数据进行读写操作。所有的磁头连在一个磁头控制器上，由磁头控制器负责各个磁头的运动，磁头可沿盘片的半径方向移动，观察下图有一个区域是磁头停泊区，当磁盘不读取数据时，磁头会摆动至磁头停泊区。

![[Pasted image 20220515150708.png]]
1. 磁头
磁头是硬盘中最昂贵的部件，也是硬盘技术中最重要和最关键的一环。传统的磁头是读写合一的电磁感应式磁头，但是，硬盘的读、写却是两种截然不同的操作，为此，这种二合一磁头在设计时必须要同时兼顾到读/写两种特性，从而造成了硬盘设计上的局限。
而MR磁头（Magneto resistive heads），即磁阻磁头，采用的是分离式的磁头结构：写入磁头仍采用传统的磁感应磁头（MR磁头不能进行写操作），读取磁头则采用新型的MR磁头，即所谓的感应写、磁阻读。这样，在设计时就可以针对两者的不同特性分别进行优化，以得到最好的读/写性能。另外，MR磁头是通过阻值变化而不是电流变化去感应信号幅度，因而对信号变化相当敏感，读取数据的准确性也相应提高。而且由于读取的信号幅度与磁道宽度无关，故磁道可以做得很窄，从而提高了盘片密度，达到每平方英寸200MB，而使用传统的磁头只能达到每平方英寸20MB，这也是MR磁头被广泛应用的最主要原因。MR磁头已得到广泛应用，而采用多层结构和磁阻效应更好的材料制作的GMR磁头（Giant Magnetoresistive heads）也逐渐开始普及。

2. 磁盘
- 磁道
当磁盘旋转时，磁头若保持在一个位置上，则每个磁头都会在磁盘表面划出一个圆形轨迹，这些圆形轨迹就叫做磁道。这些磁道用肉眼是根本看不到的，因为它们仅是盘面上以特殊方式磁化了的一些磁化区，磁盘上的信息便是沿着这样的轨道存放的。相邻磁道之间并不是紧挨着的，这是因为磁化单元相隔太近时磁性会相互产生影响，同时也为磁头的读写带来困难。一张1.44MB的3.5英寸软盘，一面有80个磁道，而硬盘上的磁道密度则远远大于此值，通常一面有成千上万个磁道。磁道的磁化方式一般由磁头迅速切换正负极改变磁道所代表的0和1。

![[Pasted image 20211010170300.png]]

- 扇区
磁盘上的每个磁道被等分为若干个弧段，这些弧段便是磁盘的扇区，每个扇区可以存放512个字节的信息，磁盘驱动器在向磁盘读取和写入数据时，要以扇区为单位。1.44MB3.5英寸的软盘，每个磁道分为18个扇区。
![[Pasted image 20211010170041.png]]
- 柱面
硬盘通常由重叠的一组盘片构成，每个盘面都被划分为数目相等的磁道，并从外缘的“0”开始编号，具有相同编号的磁道形成一个圆柱，称之为磁盘的柱面。磁盘的柱面数与一个盘单面上的磁道数是相等的。无论是双盘面还是单盘面，由于每个盘面都只有自己独一无二的磁头，因此，盘面数等于总的磁头数。所谓硬盘的CHS，即Cylinder（柱面）、Head（磁头）、Sector（扇区），只要知道了硬盘的CHS的数目，即可确定硬盘的容量，硬盘的容量=柱面数磁头数扇区数*512B。

![[Pasted image 20211010165946.png]]

- 磁盘容量计算
存储容量 ＝ 磁头数 × 磁道(柱面)数 × 每道扇区数 × 每扇区字节数

上图中磁盘是一个 3个圆盘6个磁头，7个柱面（每个盘片7个磁道） 的磁盘，图3中每条磁道有12个扇区，所以此磁盘的容量为：

存储容量 6 * 7 * 12 * 512 = 258048

> 每个磁道的扇区数一样是说的老的硬盘，外圈的密度小，内圈的密度大，每圈可存储的数据量是一样的。新的硬盘数据的密度都一致，这样磁道的周长越长，扇区就越多，存储的数据量就越大。

3. 空气过滤片
![[Pasted image 20220515152759.png]]
上图为空气过滤孔，内部有空气过滤片。
空气过滤片的作用是用来过滤硬盘透气孔进入的空气，保证硬盘内部的洁净无尘，确保硬盘的安全使用。因为硬盘有透气孔的存在，所以硬盘内部和外部环境的大气压保持一致。磁盘旋转时的气流刚好使得磁头可以悬浮起来；所以当海拔升高时，气压和空气密度降低，盘片高速旋转的气流将无法托起磁头。从而导致磁头和盘面介质层接触，造成硬盘的损坏。所以，计算机在高海拔的情况下会“罢工”。
所以不要撕掉空气过滤片，一旦撕掉，将会导致灰尘等颗粒物进入磁盘内部，附着在磁盘的表面以及磁头的表面，时间久了，这些物质可能会损伤磁盘磁道，导致磁盘损坏。

4. 串行接口
- 早期接口 IDE接口类型；
PDE硬盘的传输模式有以下三种：PIO(Programmed I/O)模式、DMA(Driect Memory Access)模式、Ultra DMA(简称UDMA)模式。
PIO(Programmed I/O)模式的最大弊端是耗用极大量的CPU资源。以PIO模式运行的IDE接口，数据传输率达3.3MB/s(PIO mode 0)
-16.6MB/s(PIO mode 4)不等。
PDMA(Direct Memory Access)模式分为Single-Word DMA及Multi-Word DMA两种。Single-Word DMA模式的最高传输率达8.33MB/s，Multi-Word DMA(Double Word)则可达16.66MB/s。
PDMA模式同PIO模式的最大区别是:DMA模式并不用过分依赖CPU的指令而运行，可达到节省处理器运行资源的效果。但由于Ultra DMA模式的出现和快速普及，这两个模式立即被UDMA所取代。
PUltra DMA模式(简称UDMA)是Ultra ATA制式下所引用的一个标准，以16-bit Multi-Word DMA模式作为基准。UDMA其中一个优点是它除了拥有DMA模式的优点外，更应用了CRC(Cyclic Redundancy Check)技术，加强了资料在传送过程中侦错及除错方面的效能。
PIDE自Ultra ATA标准推行以来，其接口便应用了DDR(Double Data Rate)技术将传输的速度提升了一倍，目前已发展到Ultra ATA/100了，其传输速度高达100MB/s。
简单来讲其特点是：IDE接口优点：价格低廉、兼容性强、性价比高；IDE接口缺点：数据传输速度慢、线缆长度过短、连接设备少。

- SATA接口；
SATA是Serial ATA的缩写，即串行ATA。它是一种电脑总线，主要功能是用作主板和大量存储设备（如硬盘及光盘驱动器）之间的数据传输之用。这是一种完全不同于串行PATA的新型硬盘接口类型，由于采用串行方式传输数据而得名。SATA总线使用嵌入式时钟信号，具备了更强的纠错能力，与以往相比其最大的区别在于能对传输指令（不仅仅是数据）进行检查，如果发现错误会自动矫正，这在很大程度上提高了数据传输的可靠性。串行接口还具有结构简单、支持热插拔的优点。
现时，SATA分别有SATA 1.5Gbit/s、SATA 3Gbit/s和SATA 6Gbit/s三种规格。即就是SATA的一代、二代、三代。

- 最新SAS接口；
SAS是新一代的SCSI技术,和现在流行的Serial ATA（SATA）硬盘相同.都是采用串行技术以获得更高的传输速度”并通过缩短连结线改善内部空间等。SAS是并行SCSI接口之后开发出的全新接口。此接口的设计是为了改善存储系统的效能、可用性和扩充性,提
供与串行ATA（Se「ial ATA ,缩写为SATA）硬盘的兼容性。
SAS的接口技术可以向下兼容SATA。SAS系统的背板既可以连接具有双端口、高性能的SAS驱动器,也可以连接高容量、低成本的SATA驱动器。因为SAS驱动器的端口与SATA驱动器的端口形状看上去类似,所以SAS驱动器和SATA驱动器可以同时存在于一个存储系统之中。但需要注意的是,SATA系统并不兼容SAS ,所以SAS驱动器不能连接到SATA背板上。由于SAS系统的兼容性，IT人员能够运用不同接口的硬盘来满足各类应用在容量上或效能上的需求，因此在扩充存储系统时拥有更多的弹性,让存储设备发挥最大的投资效益。说白了SAS接口技术就是使用串行接口的SCSI硬盘，它和SATA硬盘是兼容的,我们可以在SAS接口上安装SAS硬盘或者SATA硬盘。

5. 磁头停泊区
磁头停泊区是机械硬盘在不使用的状态，磁头不会放在存储区上面，而是无读取时将磁头放在停泊区。

6. PCB板
PCB板也就是磁盘的驱动控制器，将高速信号缓存下来存储到磁盘中，包括磁头的驱动控制等。这个一般都可以设计做，但是可能大公司做的质量好一点，信号处理器选的贵一些。

7. 主轴
硬盘主轴，驱动硬盘存储区转动的主要驱动器件；就是开机时，磁盘响起声音，就是主轴开始转动，配合磁头在读取数据。


#### 扩展
__硬盘内部不是真空__
数据硬盘的正面照片红圈标注处有一个孔，也有很多型号硬盘将这个孔放到硬盘背面电路板下边。通常日立、三星的硬盘还会特别标注"DO NOT COVER THIS HOLE",这建机械硬盘的换气孔，用来连通硬盘内部和外部环境的，既然硬盘内外是有一个气孔连接，那么硬盘内部就不可能是真空环境了。
其实硬盘内部是一个高度无尘的环境，洁净度优于10级，即每立方米空间中，直径大于0.5微米的微粒数小于10个。
这种洁净环境，人类是无法长期在内部生存的，在人类已经适应的生存环境中,这种级别的微粒数目大约为30万-100万个。但是，由于硬盘在工作时，磁头与碟片之间的距离很小，只有0.02微米，任何外界灰尘在这样的距离下都显得巨大无比。
机械硬盘的工作原理决定的。机械硬盘的磁头在工作时，要靠高速旋转的碟片产生的气流悬浮在碟片上，如果碟片内部是真空的，碟片转动后将没有气流，也就无法托举磁头了。
硬盘上的气孔是用来平衡内外气压，保持硬盘内部气压稳定的。当硬盘工作后，会产生热量，如果硬盘是完全密闭的，内部气体膨胀，导致压强改变，托举磁头的力也会随溫度变化而改变，磁头就无法稳定在同一高度工作了。因此这个气孔可平衡内外气压，使磁头稳定工作。而气孔的背面是一个空气过滤片，用来过滤空气中的灰尘，保证硬盘内部的无尘环境。

日立于2013年推出了一款氮气硬盘,将硬盘盘腔完全密闭,再充以氮气，由于氮气为惰性气体，特性随溫度变化极小，且氮气的分子量小于空气，因此对磁头产生的阻力很小，更利于磁头稳定工作。

__硬盘容量__
标称250GB的硬盘可以存储多少数据，由于生产厂商是按照1000字节当做1K字节的，1000K称为1MB；
操作系统是按照1024来计算的，也就是：250GB/1024/1024/1024*（100010001000）=232.83GB。

__硬盘转速__
硬盘转速指的是硬盘内部马达的转速，单位是RPM，RotationPerMintue。而机械硬盘内有两个这样的马达，一个是驱动磁盘转动的马达和控制磁头移动的马达，磁头的移动影响到寻道时间的快慢，磁盘马达的转速则是硬盘产品过个里面的转速资料，两者越快越好。所以现在常见的转速是5400转、7200转，少部分可以达到10000多转，即就是5400转/min。

__磁盘读取响应时间__

1.  寻道时间：磁头从开始移动到数据所在磁道所需要的时间，寻道时间越短，I/O操作越快，目前磁盘的平均寻道时间一般在3－15ms，一般都在10ms左右。
2.  旋转延迟：盘片旋转将请求数据所在扇区移至读写磁头下方所需要的时间，旋转延迟取决于磁盘转速。普通硬盘一般都是7200rpm，慢的5400rpm。
3.  数据传输时间：完成传输所请求的数据所需要的时间。  
    小结一下：从上面的指标来看、其实最重要的、或者说、我们最关心的应该只有两个：寻道时间；旋转延迟。

> 读写一次磁盘信息所需的时间可分解为：寻道时间、延迟时间、传输时间。为提高磁盘传输效率，软件应着重考虑减少寻道时间和延迟时间。


### 块/簇

#### 概述

磁盘块/簇（虚拟出来的）。 块是操作系统中最小的逻辑存储单位。操作系统与磁盘打交道的最小单位是磁盘块。\
通俗的来讲，在Windows下如NTFS等文件系统中叫做簇；在Linux下如Ext4等文件系统中叫做块（block）。每个簇或者块可以包括2、4、8、16、32、64…2的n次方个扇区。

#### 为什么存在磁盘块？

读取方便：由于扇区的数量比较小，数目众多在寻址时比较困难，所以操作系统就将相邻的扇区组合在一起，形成一个块，再对块进行整体的操作。

分离对底层的依赖：操作系统忽略对底层物理存储结构的设计。通过虚拟出来磁盘块的概念，在系统中认为块是最小的单位。

#### page

操作系统经常与内存和硬盘这两种存储设备进行通信，类似于“块”的概念，都需要一种虚拟的基本单位。所以，与内存操作，是虚拟一个页的概念来作为最小单位。与硬盘打交道，就是以块为最小单位。

#### 扇区、块/簇、page的关系

1. 扇区： 硬盘的最小读写单元
2. 块/簇： 是操作系统针对硬盘读写的最小单元
3. page： 是内存与操作系统之间操作的最小单元。

扇区 <= 块/簇 <= page

#### LBA

简单讲 现在硬盘分为两种扇区大小 一是传统的512字节 二是新型的4096字节。
总体来说4096更快 更好， 但是为了兼容操作系统（windows linux）,所以操作系统没有直接与硬盘打交道，而是通过模拟的逻辑扇区。
这张图显示逻辑扇区与物理扇区都是512字节
![[Pasted image 20220227114042.png]]
这个则是逻辑扇区为512 真实的物理扇区为4096
![[Pasted image 20220227114114.png]]

简单讲操作系统没有直接去使用磁盘的扇区 而是去使用磁盘的逻辑扇区，是为了兼容扇区不同大小的磁盘设备。

对于机械硬盘的知识，暂时就告一段落了，下面我们来看一下怎么使用一块硬盘。


### 什么是分区表？什么是分区？
首先我们需要了解一下什么是磁盘的低格和高级格式化。

__低级格式化__：低级格式化也称为物理格式化，就是将空白的磁盘划分出柱面和磁道，再将磁道划分为若干个扇区，每个扇区又划分出标识部分id、间隔区gap和数据区data等。

__高级格式化__：高级格式化是根据一定的分区格式对磁盘的进行标记,生成引导区信息、初始化空间分配表表、标注逻辑坏道、校验数据等，使操作系统能够对磁盘进行读写，所以高级格式化的方法因操作系统的不同而不同，或者说因分区格式的不同而不同。高级格式化只是对磁盘进行寻常的读写操作，对硬盘并没有不利的影响。

根据上面的描述，我们可以看出，低级格式化一般是硬盘厂商做的事情，主要是用来划分扇区，磁道等原始的存储单元，而高级格式化则是在原始的存储单元上，创建软件层面上的格式。有了这个概念之后，我们在来了解一下什么是分区表和分区。

__分区表__：分区表的作用就是把一块单独的物理硬盘，划分成几个各自相对独立的区域，便于我们更方便的运用硬盘。你的电脑中通常只有一块物理硬盘;但是一般情况下，你的电脑中不止一个C分区，还会有D、E、F等其它分区。正是分区表，把一块物理硬盘划分成了C、D、E、F等多个分区。

__分区__：由分区表划分出来的一块区域，就被成为分区，分区表中记录着该分区的起始扇区与结束扇区等信息。

思考，为什么需要分区？
按照我个人的理解，我将一个磁盘真正被使用的过程分为下图的几个步骤。
![[Pasted image 20220515165309.png]]
由此 我们知道了分区表主要的作用是为了划分磁盘上的存储单元，使得操作系统可以真正的操作这些存储单元。
下面来介绍两种常用的分区表格式。
#### mbr
MBR 也就是主引导记录，位于硬盘的 0 磁道、0 柱面、1 扇区中，主要记录了启动引导程序和磁盘的分区表。

MBR 共占用了一个扇区，也就是 512 Byte。引导程序占用其中的前446字节（偏移0～1BDH），随后的64字节（偏移1BEH～1FDH）为DPT（Disk Partition Table，硬盘分区表），最后的两个字节“55 AA”（偏移1FEH～1FFH）是结束标志。

__什么是结束标志？__
结束标志是用来标记主引导记录的标志位，在bios启动时，会读取硬盘的第一个扇区。如果没有找到这个结束标志，就不会认为这个磁盘的前446字节是系统的引导程序，也就不会加载系统。

 从主引导记录的结构可以知道，它仅仅包含一个64个字节的硬盘分区表。由于每个分区信息需要16个字节，所以对于采用MBR型分区结构的硬盘(其磁盘卷标类型为MS-DOS)，最多只能识别4个主要分区。
 那么如果想要创建五个分区时，mbr是否就不支持呢？
 mbr提供一种名叫扩展分区的方式来支持4个分区以上的情况。扩展分区也是主分区（Primary partition）的一种，在扩展分区上可以创建逻辑分区的方式来增加分区个数。
 
![[Pasted image 20220515170111.png]]


__扩展思考__
在MBR分区表中，一个分区最大的容量为2T，且每个分区的起始柱面必须在这个disk的前2T内。你有一个3T的硬盘，根据要求你至少要把它划分为2个分区，且最后一个分区的起始扇区要位于硬盘的前2T空间内。如果硬盘太大则必须改用GPT。

想一想 为什么会存在这个限制呢？
原理很简单，分区表用来存放单个分区地址的空间只有16byte，真正制约单个分区最大容量的原因，是16byte无法存放更大的地址位置了。
mbr格式的分区表第一无法创建四个以上的主分区，第二，每个分区的最大容量不能超过2T，已经无法满足现在系统的需要了。所以有了另一种更好的替代品：GPT。

#### gpt
全局唯一标识分区表（GUID Partition Table，缩写：GPT）是一个实体硬盘的分区结构。它是EFI(可扩展固件接口标准)的一部分，用来替代BIOS中的主引导记录分区表。但因为MBR分区表不支持容量大于2.2TB（2.2 × 1012字节）的分区，所以也有一些BIOS系统为了支持大容量硬盘而用GPT分区表取代MBR分区表。

下图是gpt分区表的格式，
![[Pasted image 20220515172039.png]]

- LBA0：
在GPT分区表的最开头，处于兼容性考虑仍然存储了一份传统的MBR（LBA 0），这个MBR叫做保护性MBR（Protective MBR）。
保护性MBR保护GPT磁盘不受以前发布的MBR磁盘工具的危害。这些工具不能感知GPT，也无法正确地访问GPT磁盘。这些工具通过解释保护性MBR，将GPT磁盘看成一个封装的（可能无法识别）分区，而不是错误地当成一个未分区的磁盘，并且拒绝对硬盘进行操作。这就避免了意外删除分区的危险。
在支持从GPT启动的操作系统中，这里也用于存储第一阶段的启动代码。在这个MBR中，只有一个标识为0xEE的分区，以此来表示这块硬盘使用GPT分区表。
在使用MBR/GPT混合分区表的硬盘中，这部分存储了GPT分区表的一部分分区（通常是前四个分区），可以使不支持从GPT启动的操作系统从这个MBR启动，启动后只能操作MBR分区表中的分区。

- LBA1：
分区表头（LBA 1）定义了硬盘的可用空间以及组成分区表的项的大小和数量。在使用64位Windows Server 2003的机器上，最多可以创建128个分区，即分区表中保留了128个项，其中每个都是128字节。（EFI标准要求分区表最小要有16,384字节，即128个分区项的大小）
分区表头还记录了这块硬盘的GUID，记录了分区表头本身的位置和大小以及备份分区表头和分区表的位置和大小（在硬盘的最后）。它还储存着它本身和分区表的CRC32校验。固件、引导程序和操作系统在启动时可以根据这个校验值来判断分区表是否出错，如果出错了，可以使用软件从硬盘最后的备份GPT中恢复整个分区表，如果备份GPT也校验错误，硬盘将不可使用。

- LBA 2–33
LBA 2–33的位置存放的是分区表项。GPT分区表使用简单而直接的方式表示分区。一个分区表项的前16字节是分区类型GUID。接下来的16字节是该分区唯一的GUID（这个GUID指的是该分区本身，而之前的GUID指的是该分区的类型）。再接下来是分区起始和末尾的64位LBA编号，以及分区的名字和属性。

LBA 末尾的33个逻辑扇区，是用来做备份恢复用。

__对比mbr__：
1、支持2TB以上的大硬盘，因为它用128byte表示扇区地址。

2、每个磁盘允许划分128个分区。

3、分区表自带备份。在磁盘的首尾部分分别保存了一份相同的分区表，其中一份被破坏后，可以通过另一份恢复；

4、循环冗余检验值针对关键数据结构而计算，提高了数据崩溃的检测几率；

5、 虽然MBR提供1字节分区类型代码，但GPT使用一个16字节的全局唯一标识符（GUID）值来标识分区类型，这使分区类型更不容易冲突；


### 什么是文件系统？
前面讲了一堆磁盘的物理结构和分区表，但是我们其实还没有真正的使用磁盘，仅仅有磁盘分区，这个磁盘还是无法被我们使用。
作为用户来说，磁盘存储设备最终的目的是存放/读取文件，那么怎么存放读取文件呢？直接将数据拷贝到分区内吗？

#### vfs

#### ext2/3/4

#### xfs

#### vfat/ntfs

#### 文件系统永久挂载

### 什么是挂载属性？

### 什么是文件扩展属性？

#### lsattr

#### chattr

### 什么是device mapper?

### 什么是lvm?

#### pv

#### vg

#### lv

#### 逻辑卷快照

#### 逻辑卷池

#### 逻辑卷与其他技术配合

### 什么是raid?

#### raid0

#### raid1

#### raid3

#### raid5

#### raid6

#### raid10

### 什么是磁盘加密？

#### dm-crypt

#### cryptsetup

#### 加密磁盘自动挂载

### 什么是磁盘配额？

#### quota

### 什么是loop

### 扩展 
#### DAS（Direct Attached Storage）
即**直连附加存储**，可以理解为本地文件系统。这种设备直接连接到计算机主板总线上，计算机将其识别为一个块设备，例如常见的硬盘，U盘等，这种设备很难做到共享。

##### **特点**

**DAS** 购置成本低，配置简单，使用过程和使用本机硬盘并无太大差别，对于服务器的要求仅仅是一个外接的`SCSI`口，因此对于小型企业很有吸引力。

##### **缺点**

(1) 数据备份操作复杂。

(2) 服务器本身容易成为系统瓶颈。

(3) 服务器发生故障，数据不可访问。

(4) 对于存在多个服务器的系统来说，设备分散，不便管理。


####  NAS（Network Area Storage）
即`网络附加存储`。它一般是将本地的存储空间共享给其他主机使用，一般通过C/S架构实现通信。它实现的是文件级别的共享，计算机通常将共享的设别识别为一个文件系统，其文件服务器会管理锁以实现并发访问。网络文件系统，以文件模块的形式进行共享，工作在`应用层`上，常见的NAS有`NFS`和`CIFS(FTP)`。
##### **特点**

`NAS`实际是一种带有瘦服务器的存储设备，这个瘦服务器实际是一台网络文件服务器。NAS设备直接连接到TCP/IP网络上，网络服务器通过`TCP/IP`网络存取管理数据。`NAS`作为一种瘦服务器系统，易于安装和部署，管理使用也很方便。

##### **缺点**

(1) 存储数据通过网络传输，因此容易产生数据泄漏等安全问题。

(2) 存储数据通过网络传输，因此易受网络上其它流量的影响，当网络上有其它大数据流量时会严重影响系统性能。

(3) 存储只能以文件方式访问，而不能像普通文件系统一样直接访问物理数据块，因此会在某些情况下严重影响系统效率，比如大型数据库就不能使用`NAS`这种存储方案。

##### NFS
[[01 nfs服务]]

##### SAMBA


#### SAN（Storage Area Network）
即`存储区域网络`，工作于内核层。它将传输网络模拟成`SCSI`总线来使用，每一个主机的网卡相当于SCSI总线中的initiator，服务器相当于一个或多个target，它需要借助客户端和服务端的SCSI驱动，通过FC或TCP/IP协议封装SCSI报文。它实现的是`块级别`的共享，通常被识别为一个块设备，但是需要借助专门的锁管理软件才能实现多主机并发访问。


##### **特点**

SAN实际是一种专门为存储建立的独立于TCP/IP网络之外的专用网络。目前一般的SAN提供2Gb/S到4Gb/S的传输数率，同时SAN网络独立于数据网络存在，因此存取速度很快，另外SAN一般采用高端的RAID阵列，使SAN的性能在几种专业网络存储技术中傲视群雄。SAN由于其基础是一个专用网络，因此扩展性很强，不管是在一个SAN系统中增加一定的存储空间还是增加几台使用存储空间的服务器都非常方便。

##### **缺点**

(1) 需要单独建立光纤网络，异地扩展比较困难。

(2) 不论是SAN阵列柜还是SAN必须的光纤通道交换机价格都是十分昂贵的。